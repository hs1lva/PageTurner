@startuml
actor Leitor as L
participant "EstanteDesejos" AS ESD
participant "Repositorio" as REP
participant "SistemaMatching" as SM

L -> ESD: AdicionaLivroNaListaDeDesejos()
ESD -> REP: VerificaListaTrocaLeitor()
REP -> ESD: ListaTrocaLeitor
alt Leitor Tem Livros na Estante de Troca
    ESD -> REP: VerificaExistenciaLivroEmTrocasDeOutros()
    REP -> REP: VerificaLivro()
    alt Livro Existe nas Trocas de Outro Leitor
        REP --> ESD: "LivroEncontradoNasTrocas"
        ESD -> SM: ProcurarMatchesDesejo()
        SM -> REP: ObtemLivrosDesejadosDosLeitoresInteressados()
        REP -> SM: LivrosDesejadosDisponiveis
        SM -> SM: EncontrarMatches()
        alt Existem Matches
            SM --> ESD: "MatchesEncontrados"
            ESD --> L: "NotificaMatchesEncontrados"
        else Nenhum Match
            SM --> ESD: "NenhumMatch"
            ESD --> L: "LivroAdicionadoNaListaDeDesejosSemMatches"
        end
    else Livro Não Existe nas Trocas de Outros
        REP --> ESD: "NenhumLivroNasTrocas"
        ESD --> L: "LivroAdicionadoNaListaDeDesejosSemMatches"
    end
else Leitor Não Tem Livros na Estante de Troca
    ESD --> L: "LivroAdicionadoNaListaDeDesejosMasSemLivrosParaTroca"
end
@enduml
